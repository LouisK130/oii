{% extends "master.html" %}
{% block title %}{{bin_pid}}{% endblock %}
{% block head %}
  {{ super() }}
    <script type="text/javascript">
$(document).ready(function() {
    $('#bin_view').bin_page('{{bin_pid}}','{{time_series}}');
    $('#bin_metadata').collapsing('metadata',0);
    <!-- files view -->
    $.getJSON('/{{time_series}}/api/files/{{bin_pid}}',function(r) {
      $.each(r, function(ix, f) {
        $('#fixity table').append('<tr class="tbl">'+
	  '<td class="tbl"><a href="/{{time_series}}/'+f.filename+'">'+f.filename+'</a></td>'+
	  '<td class="tbl">'+f.length+'</td>'+
	  '<td class="tbl">'+f.sha1+'</td>'+
	  '<td class="tbl">'+f.fix_time+'</td>'+
	  '<td class="tbl">'+f.local_path+'</td>'+
	  '<td class="tbl">'+
            (f.check.exists?'exists':'does not exist')+', '+
            (f.check.length?'length matches':'length does not match')+' '+
          '</td>'+
          '</tr>'
         );
        $('#fixity tr:even').addClass('tbl_even');
        $('#fixity').css('display','block');
      });
    });
});
    </script>
{% endblock head %}
{% block content %}
  <div class="major h1">Sample bin {{bin_pid}}</div>
  <div id="bin_view" class="major"></div>
  <div style="clear: both"></div>
  <div class="major inline">
    <div>
      <b>{{date}}</b>
      (<a href="/{{time_series}}/dashboard/{{bin_pid}}">Show in time series</a>)
    </div>
    <div id="bin_metadata">
      <div class="metadata_key">context</div>
{% for v in context %}
      <div>{{v}}</div>
{% endfor %}
{% for k,v in properties %}
      <div>
        <span class="metadata_key">{{k}}</span>
        <span class="metadata_value">{{v}}</span>
      </div>
{% endfor %}
    </div>
  </div>

<!-- fixity -->
<div id="fixity" style="display:none">
<table class="major inline">
<tr class="tbl">
  <th class="tbl">filename</th>
  <th class="tbl">length</th>
  <th class="tbl">sha1</th>
  <th class="tbl">fixed</th>
  <th class="tbl">local path</th>
  <th class="tbl">status</th>
</tr>
</table>
</div>

<div style="clear: both"></div>

<!-- targets -->
<div><table class="major">
<tr class="tbl">
  <th class="tbl">#/trigger</th>
  <th class="tbl">pid</th>
  <th class="tbl">size</th>
</tr>
{% for target in targets %}
  <tr class="tbl">
    <td class="tbl">{{target['targetNumber']}}/{{target['trigger']}}</td>
    <td class="tbl"><a href="{{target['pid']}}.html">{{target['pid']}}</a></td>
    <td class="tbl">{{target['width']}}x{{target['height']}}</td>
  </tr>
{% endfor %}
</table>
</div>
{% endblock content %}
